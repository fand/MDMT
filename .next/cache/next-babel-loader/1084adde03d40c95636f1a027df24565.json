{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault2 = require(\"@babel/runtime-corejs2/helpers/interopRequireDefault\");\n\nvar _regenerator = _interopRequireDefault2(require(\"@babel/runtime-corejs2/regenerator\"));\n\nvar _classCallCheck2 = _interopRequireDefault2(require(\"@babel/runtime-corejs2/helpers/esm/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault2(require(\"@babel/runtime-corejs2/helpers/esm/createClass\"));\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs2/helpers/interopRequireDefault\");\n\nexports.__esModule = true;\nexports[\"default\"] = void 0;\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/asyncToGenerator\"));\n\nvar _promise = _interopRequireDefault(require(\"@babel/runtime-corejs2/core-js/promise\"));\n\nvar _set = _interopRequireDefault(require(\"@babel/runtime-corejs2/core-js/set\"));\n\nvar _mitt = _interopRequireDefault(require(\"next-server/dist/lib/mitt\"));\n\nvar _unfetch = _interopRequireDefault(require(\"unfetch\"));\n/* global document */\n// smaller version of https://gist.github.com/igrigorik/a02f2359f3bc50ca7a9c\n\n\nfunction supportsPreload(list) {\n  if (!list || !list.supports) {\n    return false;\n  }\n\n  try {\n    return list.supports('preload');\n  } catch (e) {\n    return false;\n  }\n}\n\nvar hasPreload = supportsPreload(document.createElement('link').relList);\n\nvar PageLoader =\n/*#__PURE__*/\nfunction () {\n  function PageLoader(buildId, assetPrefix) {\n    (0, _classCallCheck2[\"default\"])(this, PageLoader);\n    this.buildId = buildId;\n    this.assetPrefix = assetPrefix;\n    this.pageCache = {};\n    this.prefetchCache = new _set[\"default\"]();\n    this.pageRegisterEvents = (0, _mitt[\"default\"])();\n    this.loadingRoutes = {};\n    this.promisedBuildId = _promise[\"default\"].resolve();\n  }\n\n  (0, _createClass2[\"default\"])(PageLoader, [{\n    key: \"normalizeRoute\",\n    value: function normalizeRoute(route) {\n      if (route[0] !== '/') {\n        throw new Error(\"Route name should start with a \\\"/\\\", got \\\"\" + route + \"\\\"\");\n      }\n\n      route = route.replace(/\\/index$/, '/');\n      if (route === '/') return route;\n      return route.replace(/\\/$/, '');\n    }\n  }, {\n    key: \"loadPage\",\n    value: function loadPage(route) {\n      var _this3 = this;\n\n      route = this.normalizeRoute(route);\n      return new _promise[\"default\"](function (resolve, reject) {\n        var fire = function fire(_ref) {\n          var error = _ref.error,\n              page = _ref.page;\n\n          _this3.pageRegisterEvents.off(route, fire);\n\n          delete _this3.loadingRoutes[route];\n\n          if (error) {\n            reject(error);\n          } else {\n            resolve(page);\n          }\n        }; // If there's a cached version of the page, let's use it.\n\n\n        var cachedPage = _this3.pageCache[route];\n\n        if (cachedPage) {\n          var error = cachedPage.error,\n              page = cachedPage.page;\n          error ? reject(error) : resolve(page);\n          return;\n        } // Register a listener to get the page\n\n\n        _this3.pageRegisterEvents.on(route, fire); // If the page is loading via SSR, we need to wait for it\n        // rather downloading it again.\n\n\n        if (document.getElementById(\"__NEXT_PAGE__\" + route)) {\n          return;\n        } // Load the script if not asked to load yet.\n\n\n        if (!_this3.loadingRoutes[route]) {\n          _this3.loadScript(route);\n\n          _this3.loadingRoutes[route] = true;\n        }\n      });\n    }\n  }, {\n    key: \"onDynamicBuildId\",\n    value: function onDynamicBuildId() {\n      var _this4 = this;\n\n      this.promisedBuildId = new _promise[\"default\"](function (resolve) {\n        (0, _unfetch[\"default\"])(_this4.assetPrefix + \"/_next/static/HEAD_BUILD_ID\").then(function (res) {\n          if (res.ok) {\n            return res;\n          }\n\n          var err = new Error('Failed to fetch HEAD buildId');\n          err.res = res;\n          throw err;\n        }).then(function (res) {\n          return res.text();\n        }).then(function (buildId) {\n          _this4.buildId = buildId.trim();\n        })[\"catch\"](function () {\n          // When this fails it's not a _huge_ deal, preload wont work and page\n          // navigation will 404, triggering a SSR refresh\n          console.warn('Failed to load BUILD_ID from server. ' + 'The following client-side page transition will likely 404 and cause a SSR.\\n' + 'http://err.sh/zeit/next.js/head-build-id');\n        }).then(resolve, resolve);\n      });\n    }\n  }, {\n    key: \"loadScript\",\n    value: function loadScript(route) {\n      var _this = this;\n\n      return (0, _asyncToGenerator2[\"default\"])(\n      /*#__PURE__*/\n      _regenerator[\"default\"].mark(function _callee() {\n        var scriptRoute, script, url;\n        return _regenerator[\"default\"].wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return _this.promisedBuildId;\n\n              case 2:\n                route = _this.normalizeRoute(route);\n                scriptRoute = route === '/' ? '/index.js' : route + \".js\";\n                script = document.createElement('script');\n                url = _this.assetPrefix + \"/_next/static/\" + encodeURIComponent(_this.buildId) + \"/pages\" + scriptRoute;\n                script.crossOrigin = process.crossOrigin;\n                script.src = url;\n\n                script.onerror = function () {\n                  var error = new Error(\"Error loading script \" + url);\n                  error.code = 'PAGE_LOAD_ERROR';\n\n                  _this.pageRegisterEvents.emit(route, {\n                    error: error\n                  });\n                };\n\n                document.body.appendChild(script);\n\n              case 10:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }))();\n    } // This method if called by the route code.\n\n  }, {\n    key: \"registerPage\",\n    value: function registerPage(route, regFn) {\n      var _this5 = this;\n\n      var register = function register() {\n        try {\n          var _regFn = regFn(),\n              error = _regFn.error,\n              page = _regFn.page;\n\n          _this5.pageCache[route] = {\n            error: error,\n            page: page\n          };\n\n          _this5.pageRegisterEvents.emit(route, {\n            error: error,\n            page: page\n          });\n        } catch (error) {\n          _this5.pageCache[route] = {\n            error: error\n          };\n\n          _this5.pageRegisterEvents.emit(route, {\n            error: error\n          });\n        }\n      };\n\n      if (process.env.NODE_ENV !== 'production') {\n        // Wait for webpack to become idle if it's not.\n        // More info: https://github.com/zeit/next.js/pull/1511\n        if (module.hot && module.hot.status() !== 'idle') {\n          console.log(\"Waiting for webpack to become \\\"idle\\\" to initialize the page: \\\"\" + route + \"\\\"\");\n\n          var check = function check(status) {\n            if (status === 'idle') {\n              module.hot.removeStatusHandler(check);\n              register();\n            }\n          };\n\n          module.hot.status(check);\n          return;\n        }\n      }\n\n      register();\n    }\n  }, {\n    key: \"prefetch\",\n    value: function prefetch(route) {\n      var _this2 = this;\n\n      return (0, _asyncToGenerator2[\"default\"])(\n      /*#__PURE__*/\n      _regenerator[\"default\"].mark(function _callee2() {\n        var scriptRoute, link;\n        return _regenerator[\"default\"].wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                route = _this2.normalizeRoute(route);\n                scriptRoute = (route === '/' ? '/index' : route) + \".js\";\n\n                if (!(_this2.prefetchCache.has(scriptRoute) || document.getElementById(\"__NEXT_PAGE__\" + route))) {\n                  _context2.next = 4;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\");\n\n              case 4:\n                _this2.prefetchCache.add(scriptRoute); // Inspired by quicklink, license: https://github.com/GoogleChromeLabs/quicklink/blob/master/LICENSE\n                // Don't prefetch if the user is on 2G / Don't prefetch if Save-Data is enabled\n\n\n                if (!('connection' in navigator)) {\n                  _context2.next = 8;\n                  break;\n                }\n\n                if (!((navigator.connection.effectiveType || '').indexOf('2g') !== -1 || navigator.connection.saveData)) {\n                  _context2.next = 8;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\");\n\n              case 8:\n                if (!hasPreload) {\n                  _context2.next = 18;\n                  break;\n                }\n\n                _context2.next = 11;\n                return _this2.promisedBuildId;\n\n              case 11:\n                link = document.createElement('link');\n                link.rel = 'preload';\n                link.crossOrigin = process.crossOrigin;\n                link.href = _this2.assetPrefix + \"/_next/static/\" + encodeURIComponent(_this2.buildId) + \"/pages\" + scriptRoute;\n                link.as = 'script';\n                document.head.appendChild(link);\n                return _context2.abrupt(\"return\");\n\n              case 18:\n                if (!(document.readyState === 'complete')) {\n                  _context2.next = 22;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\", _this2.loadPage(route)[\"catch\"](function () {}));\n\n              case 22:\n                return _context2.abrupt(\"return\", new _promise[\"default\"](function (resolve) {\n                  window.addEventListener('load', function () {\n                    _this2.loadPage(route).then(function () {\n                      return resolve();\n                    }, function () {\n                      return resolve();\n                    });\n                  });\n                }));\n\n              case 23:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }))();\n    }\n  }, {\n    key: \"clearCache\",\n    value: function clearCache(route) {\n      route = this.normalizeRoute(route);\n      delete this.pageCache[route];\n      delete this.loadingRoutes[route];\n      var script = document.getElementById(\"__NEXT_PAGE__\" + route);\n\n      if (script) {\n        script.parentNode.removeChild(script);\n      }\n    }\n  }]);\n  return PageLoader;\n}();\n\nexports[\"default\"] = PageLoader;","map":{"version":3,"sources":["/Users/amagi/src/github.com/fand/next-docs-template/node_modules/next/dist/client/page-loader.js"],"names":["_interopRequireDefault","require","exports","__esModule","_asyncToGenerator2","_promise","_set","_mitt","_unfetch","supportsPreload","list","supports","e","hasPreload","document","createElement","relList","PageLoader","buildId","assetPrefix","pageCache","prefetchCache","pageRegisterEvents","loadingRoutes","promisedBuildId","resolve","route","Error","replace","normalizeRoute","reject","fire","_ref","error","page","off","cachedPage","on","getElementById","loadScript","then","res","ok","err","text","trim","console","warn","_this","scriptRoute","script","url","encodeURIComponent","crossOrigin","process","src","onerror","code","emit","body","appendChild","regFn","register","env","NODE_ENV","module","hot","status","log","check","removeStatusHandler","_this2","has","add","navigator","connection","effectiveType","indexOf","saveData","link","rel","href","as","head","readyState","loadPage","window","addEventListener","parentNode","removeChild"],"mappings":"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","sourcesContent":["\"use strict\";var _interopRequireDefault=require(\"@babel/runtime-corejs2/helpers/interopRequireDefault\");exports.__esModule=true;exports.default=void 0;var _asyncToGenerator2=_interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/asyncToGenerator\"));var _promise=_interopRequireDefault(require(\"@babel/runtime-corejs2/core-js/promise\"));var _set=_interopRequireDefault(require(\"@babel/runtime-corejs2/core-js/set\"));var _mitt=_interopRequireDefault(require(\"next-server/dist/lib/mitt\"));var _unfetch=_interopRequireDefault(require(\"unfetch\"));/* global document */ // smaller version of https://gist.github.com/igrigorik/a02f2359f3bc50ca7a9c\nfunction supportsPreload(list){if(!list||!list.supports){return false;}try{return list.supports('preload');}catch(e){return false;}}const hasPreload=supportsPreload(document.createElement('link').relList);class PageLoader{constructor(buildId,assetPrefix){this.buildId=buildId;this.assetPrefix=assetPrefix;this.pageCache={};this.prefetchCache=new _set.default();this.pageRegisterEvents=(0,_mitt.default)();this.loadingRoutes={};this.promisedBuildId=_promise.default.resolve();}normalizeRoute(route){if(route[0]!=='/'){throw new Error(\"Route name should start with a \\\"/\\\", got \\\"\"+route+\"\\\"\");}route=route.replace(/\\/index$/,'/');if(route==='/')return route;return route.replace(/\\/$/,'');}loadPage(route){route=this.normalizeRoute(route);return new _promise.default((resolve,reject)=>{const fire=(_ref)=>{let{error,page}=_ref;this.pageRegisterEvents.off(route,fire);delete this.loadingRoutes[route];if(error){reject(error);}else{resolve(page);}};// If there's a cached version of the page, let's use it.\nconst cachedPage=this.pageCache[route];if(cachedPage){const{error,page}=cachedPage;error?reject(error):resolve(page);return;}// Register a listener to get the page\nthis.pageRegisterEvents.on(route,fire);// If the page is loading via SSR, we need to wait for it\n// rather downloading it again.\nif(document.getElementById(\"__NEXT_PAGE__\"+route)){return;}// Load the script if not asked to load yet.\nif(!this.loadingRoutes[route]){this.loadScript(route);this.loadingRoutes[route]=true;}});}onDynamicBuildId(){this.promisedBuildId=new _promise.default(resolve=>{(0,_unfetch.default)(this.assetPrefix+\"/_next/static/HEAD_BUILD_ID\").then(res=>{if(res.ok){return res;}const err=new Error('Failed to fetch HEAD buildId');err.res=res;throw err;}).then(res=>res.text()).then(buildId=>{this.buildId=buildId.trim();}).catch(()=>{// When this fails it's not a _huge_ deal, preload wont work and page\n// navigation will 404, triggering a SSR refresh\nconsole.warn('Failed to load BUILD_ID from server. '+'The following client-side page transition will likely 404 and cause a SSR.\\n'+'http://err.sh/zeit/next.js/head-build-id');}).then(resolve,resolve);});}loadScript(route){var _this=this;return(0,_asyncToGenerator2.default)(function*(){yield _this.promisedBuildId;route=_this.normalizeRoute(route);const scriptRoute=route==='/'?'/index.js':route+\".js\";const script=document.createElement('script');const url=_this.assetPrefix+\"/_next/static/\"+encodeURIComponent(_this.buildId)+\"/pages\"+scriptRoute;script.crossOrigin=process.crossOrigin;script.src=url;script.onerror=()=>{const error=new Error(\"Error loading script \"+url);error.code='PAGE_LOAD_ERROR';_this.pageRegisterEvents.emit(route,{error});};document.body.appendChild(script);})();}// This method if called by the route code.\nregisterPage(route,regFn){const register=()=>{try{const{error,page}=regFn();this.pageCache[route]={error,page};this.pageRegisterEvents.emit(route,{error,page});}catch(error){this.pageCache[route]={error};this.pageRegisterEvents.emit(route,{error});}};if(process.env.NODE_ENV!=='production'){// Wait for webpack to become idle if it's not.\n// More info: https://github.com/zeit/next.js/pull/1511\nif(module.hot&&module.hot.status()!=='idle'){console.log(\"Waiting for webpack to become \\\"idle\\\" to initialize the page: \\\"\"+route+\"\\\"\");const check=status=>{if(status==='idle'){module.hot.removeStatusHandler(check);register();}};module.hot.status(check);return;}}register();}prefetch(route){var _this2=this;return(0,_asyncToGenerator2.default)(function*(){route=_this2.normalizeRoute(route);const scriptRoute=(route==='/'?'/index':route)+\".js\";if(_this2.prefetchCache.has(scriptRoute)||document.getElementById(\"__NEXT_PAGE__\"+route)){return;}_this2.prefetchCache.add(scriptRoute);// Inspired by quicklink, license: https://github.com/GoogleChromeLabs/quicklink/blob/master/LICENSE\n// Don't prefetch if the user is on 2G / Don't prefetch if Save-Data is enabled\nif('connection'in navigator){if((navigator.connection.effectiveType||'').indexOf('2g')!==-1||navigator.connection.saveData){return;}}// Feature detection is used to see if preload is supported\n// If not fall back to loading script tags before the page is loaded\n// https://caniuse.com/#feat=link-rel-preload\nif(hasPreload){yield _this2.promisedBuildId;const link=document.createElement('link');link.rel='preload';link.crossOrigin=process.crossOrigin;link.href=_this2.assetPrefix+\"/_next/static/\"+encodeURIComponent(_this2.buildId)+\"/pages\"+scriptRoute;link.as='script';document.head.appendChild(link);return;}if(document.readyState==='complete'){return _this2.loadPage(route).catch(()=>{});}else{return new _promise.default(resolve=>{window.addEventListener('load',()=>{_this2.loadPage(route).then(()=>resolve(),()=>resolve());});});}})();}clearCache(route){route=this.normalizeRoute(route);delete this.pageCache[route];delete this.loadingRoutes[route];const script=document.getElementById(\"__NEXT_PAGE__\"+route);if(script){script.parentNode.removeChild(script);}}}exports.default=PageLoader;"]},"metadata":{},"sourceType":"script"}